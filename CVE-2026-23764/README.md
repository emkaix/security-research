# CVE-2026-23764 VB-Audio Voicemeeter & Matrix Drivers DoS via Corrupted IoAllocateMdl Length

**CVSS Score:** 6.8  
**CVSS Severity:** Medium  
**Vector:** `CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N`  
**CWE ID:** `CWE-823: Use of Out-of-range Pointer Offset`

## Vulnerability description

VB-Audio Voicemeeter, Voicemeeter Banana, and Voicemeeter Potato (versions ending in 1.1.1.9, 2.1.1.9, and 3.1.1.9 and earlier, respectively), as well as VB-Audio Matrix and Matrix Coconut (versions ending in 1.0.2.2 and 2.0.2.2 and earlier, respectively), contain a vulnerability in their virtual audio drivers (vbvoicemeetervaio64*.sys, vbmatrixvaio64*.sys, vbaudio_vmauxvaio*.sys, vbaudio_vmvaio*.sys, and vbaudio_vmvaio3*.sys). The drivers allocate non-paged pool and map it into user space, where a length value associated with the allocation is exposed and can be modified by an unprivileged local attacker. On subsequent IOCTL handling, the corrupted length is used directly as the IoAllocateMdl length argument without adequate integrity checks before building and mapping the MDL, which can cause a kernel crash (BSoD), typically PAGE_FAULT_IN_NONPAGED_AREA. This flaw allows a local user to trigger a denial-of-service on affected Windows systems.

## Vendor Information

Vendor: VB-Audio Software  
Vendor URL: https://vb-audio.com/

## Affected Products


| Product | Link | Archived Download Link
| :--- | :--- | :--- |
| VB-Audio Voicemeeter (Standard) $\le 1.1.1.9$ | https://vb-audio.com/Voicemeeter/index.htm | https://web.archive.org/web/20251119122339/https://download.vb-audio.com/Download_CABLE/VoicemeeterSetup_v1119.zip |
| VB-Audio Voicemeeter Banana $\le 2.1.1.9$ | https://vb-audio.com/Voicemeeter/banana.htm | https://web.archive.org/web/20251119122402/https://download.vb-audio.com/Download_CABLE/VoicemeeterSetup_v2119.zip |
| VB-Audio Voicemeeter Potato $\le 3.1.1.9$ | https://vb-audio.com/Voicemeeter/potato.htm | https://web.archive.org/web/20250328092122/https://download.vb-audio.com/Download_CABLE/Voicemeeter8Setup_v3119.zip |
| VB-Audio Matrix $\le 1.0.2.2$ | https://vb-audio.com/Matrix/index.htm | https://web.archive.org/web/20251119123419/https://download.vb-audio.com/Download_Mixer/VBAudioMatrix_Setup_v1022.zip |
| VB-Audio Matrix Coconut $\le 2.0.2.2$ | https://vb-audio.com/Matrix/coconut.htm | https://web.archive.org/web/20251112152421/https://download.vb-audio.com/Download_Mixer/VBAudioMatrix_Setup_v2022.zip |

> [!NOTE]
> Voicemeeter Potato installation also includes Voicemeeter Banana and Voicemeeter (Standard).   
> Voicemeeter Banana installation also includes Voicemeeter (Standard). 




| Vulnerable Driver | OS | Installed With
| :--- | :--- | :--- |
| vbmatrixvaio64\*_win10.sys $\le 3.4.1.3$ | Win 10/11 | Matrix, Matrix Coconut | 
| vbvoicemeetervaio64\*_win10.sys $\le 3.3.1.9$ | Win 10/11 | Voicemeeter, Voicemeeter Banana, Voicemeeter Potato $\ge \*.1.0.0$| 
| vbaudio_vmauxvaio\*.sys $\le 2.1.5.2$ | Win 7/10/11 | Voicemeeter, Voicemeeter Banana, Voicemeeter Potato $\le \*.1.0.0$|
| vbaudio_vmvaio\*.sys $\le 2.1.5.2$ | Win 7/10/11 | Voicemeeter, Voicemeeter Banana, Voicemeeter Potato $\le \*.1.0.0$|
| vbaudio_vmvaio3\*.sys $\le 2.1.5.2$ | Win 7/10/11 | Voicemeeter, Voicemeeter Banana, Voicemeeter Potato $\le \*.1.0.0$|

> [!NOTE]
> Voicemeeter installation package includes every variation of the drivers, i.e.: 32/64 bit, x64/ARM, as well as variants for different Windows versions (2003, Vista, XP, Win7, Win10). The list above uses wildcards in the driver name to account for the different suffixes. The codebase for all those different versions is the same.

## Tested Environments
- `Windows 11, Version 10.0.26100 Build 26100`
- `Windows 10, Version 10.0.19045 Build 19045`
- `Windows 7, Version 6.1.7601 Service Pack 1 Build 7601`

## Technical Details

A handle to the driver must be created by using `CreateFileA` with `dwFlagsAndAttributes` of `0x800`. The driver checks this value specificly to recognize Voicemeeter / Matrix opening the handle.

In the `MajorFunction[IRP_MJ_DEVICE_CONTROL]` handler function, the driver maps non-paged pool kernel memory allocated with `ExAllocatePool2` / `ExAllocatePoolWithTag` into user-space with `MmMapLockedPagesSpecifyCache` with IOCTL `0x222054` (`vbvoicemeetervaio64*_win10.sys` and `vbmatrixvaio64*_win10.sys`), IOCTL `0x222044` (`vbaudio_vmauxvaio*.sys`, `vbaudio_vmvaio*.sys` and `vbaudio_vmvaio3*.sys`) and IOCTL `0x222060` (`vbmatrixvaio64*_win10.sys`).

The pool allocation is done once on driver initialization, and the length of the allocation is written into the buffer at a specific offset. The IOCTL call then reads the length value from this buffer, and uses the functions `IoAllocateMdl`, `MmBuildMdlForNonPagedPool` and `MmMapLockedPagesSpecifyCache` to map the buffer into user-space with read/write permissions.

`IoAllocateMdl` receives the length value (second parameter) directly from the buffer. Since the buffer is allocated only once, every subsequent IOCTL call maps the same buffer to user-space, using the functions `IoAllocateMdl`, `MmBuildMdlForNonPagedPool` and `MmMapLockedPagesSpecifyCache`. An attacker can do the following:

1. Use IOCTL `0x222054`, `0x222044` or `0x222060` (depending on the version)
2. Receive access to the shared memory in user-space with read/write permissions to the stored length value
3. Overwrite the length value to a very large value
4. Use the IOCTL again, this causes `IoAllocateMdl` to use the corrupted length value
5. A BSoD is caused in the subsequent `MmBuildMdlForNonPagedPool` call (usually `PAGE_FAULT_IN_NONPAGED_AREA`)

## How to reproduce

1. Install Windows 11 in a VM.
2. Download and install one of the products listed above.
3. Compile the PoC code using latest MSVC 64bit.
4. Run the PoC executable.

## Screenshots

### IDA decompilation of the IOCTL handler function in `vbvoicemeetervaio64_win10.sys`

![IDA Decompilation](images/image1.png)

